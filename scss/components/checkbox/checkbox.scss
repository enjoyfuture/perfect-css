// checkbox style
@import "./variables";
@import "./function";

// 基本样式
.checkbox {
  position:      relative;
  box-sizing:    border-box;
  display:       inline-block;
  width:         $checkbox-outline-size;
  height:        $checkbox-outline-size;
  padding:       ($checkbox-outline-size - $checkbox-size) / 2;
  border-radius: 50%;
  cursor:        pointer;
  will-change:   opacity, transform, border-color, background-color, color;

  // checkbox 形状
  &-background {
    position:       absolute;
    left:           ($checkbox-outline-size - $checkbox-size) / 2;
    box-sizing:     border-box;
    display:        inline-block;
    width:          $checkbox-pct;
    height:         $checkbox-pct;
    pointer-events: none;
  }

  &-mark-outer {
    @include theme-prop(border-color, text-primary-on-light);
    position:      absolute;
    top:           0;
    left:          0;
    box-sizing:    border-box;
    width:         100%;
    height:        100%;
    border-width:  2px;
    border-style:  solid;
    border-radius: 2px;
    transition:    checkbox-leave(border-color);
  }

  // 勾选后的样式
  &-mark-inner {
    @include theme-prop(background-color, text-primary-on-light);
    position:      absolute;
    top:           0;
    left:          0;
    box-sizing:    border-box;
    width:         100%;
    height:        100%;
    border-radius: 2px;
    transform:     scale(0, 0);
    transition:    checkbox-leave(transform), checkbox-leave(background-color);

    &::after {
      content:       "";
      position:      absolute;
      top:           3px;
      left:          2px;
      box-sizing:    border-box;
      width:         80%;
      height:        40%;
      border-bottom: 2px solid #fff;
      border-left:   2px solid #fff;
      transform:     rotate(-45deg);
    }
  }

  &-native-control {
    position: absolute;
    top:      0;
    left:     0;
    z-index:  1;
    width:    100%;
    height:   100%;
    padding:  0;
    margin:   0;
    cursor:   inherit;
    opacity:  0;
  }
}

// checked 和 disabled 动画效果
.checkbox-native-control:checked,
.checkbox-native-control:disabled,
.checkbox-native-control:indeterminate {
  + .checkbox-background {
    transition: checkbox-enter(opacity), checkbox-enter(transform);

    .checkbox-mark-outer {
      transition: checkbox-enter(border-color);
    }

    .checkbox-mark-inner {
      transition: checkbox-enter(transform), checkbox-enter(background-color);
    }
  }
}

.checkbox-disabled {
  pointer-events: none;
  cursor:         default;
}

.checkbox-native-control:checked,
.checkbox-native-control:indeterminate {
  + .checkbox-background {
    .checkbox-mark-outer {
      border:    0;
      transform: scale(0);
    }

    .checkbox-mark-inner {
      transform:  scale(1);
      transition: checkbox-enter(transform), checkbox-enter(background-color);
    }
  }
}

.checkbox-native-control:disabled {
  + .checkbox-background {
    cursor: default;

    .checkbox-mark-outer {
      border-color: rgba(#000, .26);
    }

    .checkbox-mark-inner {
      background-color: rgba(#000, .26);
    }
  }
}

.checkbox-native-control:indeterminate {
  + .checkbox-background {

    .checkbox-mark-inner::after {
      border-left: 0;
      transform:   rotate(0);
    }
  }
}

.checkbox-native-control:focus {
  + .checkbox-background::before {
    opacity:    .26;
    transform:  scale(2, 2);
    transition: checkbox-enter(opacity), checkbox-enter(transform);
  }
}

// 定义主题样式

@each $style in ("primary", "accent") {
  .checkbox-#{$style} {
    .checkbox-mark-outer {
      @include theme-prop(border-color, #{$style});
    }

    .checkbox-mark-inner {
      @include theme-prop(background-color, #{$style});

      &::after {
        @include theme-prop(border-color, text-primary-on-#{$style});
      }
    }
  }
}

// 辅助颜色对应 checkbox
@each $theme, $color in $theme-assist-colors {
  .checkbox-#{$theme} {
    .checkbox-mark-outer {
      @include theme-assist(border-color, $theme, $color);
    }

    .checkbox-mark-inner {
      @include theme-assist(background-color, $theme, $color);

      &::after {
        $color-tone: theme-light-or-dark($color);
        // 判断是用浅色还是深色
        border-color: map-get(map-get($theme-text-colors, $color-tone), primary);
      }
    }

    .checkbox-native-control:disabled {
      + .checkbox-background {
        .checkbox-mark-outer {
          border-color: rgba($color, .26);
        }

        .checkbox-mark-inner {
          background-color: rgba($color, .26);
          &::after {
            opacity: .46;
          }
        }
      }
    }
  }
}
