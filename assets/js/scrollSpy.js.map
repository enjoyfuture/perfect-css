{"version":3,"sources":["scrollSpy.js"],"names":["getUuid","isWheel","offset","position","win","window","doc","document","Array","prototype","forEach","map","_ScrollSpy","element","config","scrollEvent","event","process","scrollElement","tagName","getConfig","menu","menuClsPrefix","extend","menuSelector","offsets","targets","activeTarget","scrollHeight","extendStyle","createElement","innerHTML","getElementsByTagName","append","addEventListener","immedLoad","initMenus","anchor","generateMenus","menuPanel","$menuPanel","querySelector","menuElements","querySelectorAll","call","e","preventDefault","stopPropagation","el","currentTarget","dataset","offsetMethod","container","offsetXY","targetEl","parentNode","top","offsetBase","getScrollTop","scrollTo","blur","pluginConfig","plugins","isArray","plugin","instance","mount","push","refresh","_config","defaultConfig","id","body","autoMethod","method","menus","entries","level","children","depth","parent","text","root","prevLevel","lastNode","index","entry","parseInt","ancestor","html","generateMenusHtml","prefix","nodes","menuCls","length","i","len","node","newChild","className","href","setAttribute","insertBefore","firstChild","getScrollHeight","target","selector","getAttribute","targetSelector","targetBCR","getBoundingClientRect","width","height","sort","a","b","item","scrollTop","maxScroll","getOffsetHeight","activate","clearActiveCls","isActiveTarget","undefined","queries","split","lastSelector","parentEls","query","catalog","it","join","$link","classList","add","scrollMenu","activeEls","remove","removeEventListener","unmount","pageYOffset","Math","max","documentElement","innerHeight","animation","ScrollSpy","perfect"],"mappings":"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","file":"scrollSpy.js","sourcesContent":["import perfect from './perfect';\nimport util from './util';\nconst {getUuid, isWheel, offset, position} = util;\n\nconst win = window;\nconst doc = document;\nconst {forEach, map} = Array.prototype;\n\nclass _ScrollSpy {\n  static defaultConfig = {\n    offset: 0,\n    method: 'auto',\n    menu: '', // 菜单导航\n    menuCls: null, // 自定义菜单样式\n    menuClsPrefix: 'menu', // 菜单样式前缀\n    container: null, // 需要监听的内容容器\n    immedLoad: true, // 是否立即监听，如果设为 false， 则通过滑动鼠标来激活监听\n    prefix: 'menu-', // 导航目录前缀\n    anchor: true, // 是否用锚点来控制，默认用锚点处理\n    animation: true, // 是否开启动画\n    extend: false, // 默认菜单没有展开\n  };\n\n  constructor(element, config = {}) {\n    this.element = element;\n    this.scrollElement = element.tagName === 'BODY' ? win : element;\n    this.config = this.getConfig(config);\n    const {menu, menuClsPrefix, extend} = this.config;\n    // 菜单 目录 等选择器\n    this.menuSelector = `${menu} .${menuClsPrefix}-title`;\n    this.offsets = [];\n    this.targets = [];\n    this.activeTarget = null;\n    this.scrollHeight = 0;\n\n    // 如果默认不展开，则用样式来控制\n    if (!extend) {\n      const extendStyle = doc.createElement('style');\n      extendStyle.innerHTML = `\n          .menu-catalogue .menu-catalogue {\n            display: none;\n          }\n          .active + .menu-catalogue {\n            display: block;\n          }`;\n      doc.getElementsByTagName('head')[0].append(extendStyle);\n    }\n\n    // 添加事件，页面滚动时，处理目录和内容对应坐标\n    this.scrollElement.addEventListener(isWheel ? 'mousewheel' : 'DOMMouseScroll', this.scrollEvent, false);\n    const {immedLoad, initMenus, anchor} = this.config;\n    // 需要根据内容动态创建菜单列表\n    if (initMenus) {\n      this.generateMenus();\n    }\n\n    // 菜单面板\n    this.menuPanel = `${menu} .${menuClsPrefix}.${menuClsPrefix}-catalogue`;\n    this.$menuPanel = doc.querySelector(this.menuPanel);\n\n    // 不用锚点处理的情况\n    if (anchor === false) {\n      // fixme 待改进，改成 事件代理模式\n      const menuElements = doc.querySelectorAll(this.menuSelector);\n      forEach.call(menuElements, (element) => {\n        element.addEventListener('click', (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n          const el = e.currentTarget;\n          const {menu} = el.dataset;\n          const {offsetMethod, container} = this.config;\n          const offsetXY = this.config.offset;\n\n          const targetEl = doc.querySelector(`${container} [data-target=\"${menu}\"]`).parentNode;\n          const top = offsetMethod === 'offset' ? offset(targetEl).top : position(targetEl).top;\n          const offsetBase = offsetMethod === 'position' ? this.getScrollTop() : 0;\n\n          // fixme\n          this.scrollElement.scrollTo(0, top + offsetBase - offsetXY);\n          el.blur();\n          this.process();\n        }, false);\n      });\n    }\n\n    // 加载插件\n    const {pluginConfig} = this.config;\n    let {plugins} = this.config;\n    if (plugins) {\n      if (!Array.isArray(plugins)) {\n        plugins = [plugins];\n      }\n      this.plugins = [];\n      const {container} = this.config;\n      plugins.forEach((plugin) => {\n        // 把当前实例传给插件\n        const instance = new plugin(this, pluginConfig);\n        instance.mount();\n        this.plugins.push(instance);\n      });\n    }\n\n    // 显示菜单\n    // doc.querySelector(menu).style.display = 'block';\n    if (immedLoad) {\n      this.refresh();\n      this.process();\n    }\n  }\n\n  getConfig(config) {\n    const _config = {..._ScrollSpy.defaultConfig, ...config};\n\n    const {menu} = _config;\n    let {container} = _config;\n\n    if (typeof menu !== 'string') { // dom 对象\n      let {id} = menu;\n      if (!id) {\n        id = getUuid('scrollspy');\n        menu.id = id;\n      }\n      _config.menu = `#${id}`;\n    }\n\n    if (!container) {\n      container = doc.body; // 默认取 body\n    }\n    if (typeof container !== 'string') {\n      let {id} = container;\n      if (!id) {\n        id = getUuid('scrollspy');\n        container.id = id;\n      }\n      _config.container = `#${id}`;\n    }\n\n    const autoMethod = this.scrollElement !== this.scrollElement.window ?\n      'position' :\n      'offset';\n\n    const offsetMethod = _config.method === 'auto' ?\n      autoMethod :\n      _config.method;\n\n    _config.offsetMethod = offsetMethod;\n\n    return _config;\n  }\n\n  /**\n   * 动态创建菜单\n   */\n  generateMenus() {\n    const menus = this.element.querySelectorAll('h1,h2,h3,h4,h5,h6');\n    // 初始化根节点\n    const entries = {\n      level: 0,\n      children: [],\n      depth: 0,\n      parent: null,\n      text: null,\n      root: true\n    };\n\n    // 前一个元素 level\n    let prevLevel = 0;\n    // 上一个节点\n    let lastNode = null;\n\n    forEach.call(menus, (el, index) => {\n      let entry = null;\n      const level = 7 - parseInt(el.tagName[1], 10);\n      const text = el.innerHTML;\n\n      if (index === 0) {\n        // 初始化第一个元素\n        entry = {\n          level,\n          children: [],\n          depth: 1,\n          parent: entries,\n          text,\n          el\n        };\n        entries.children.push(entry);\n      } else {\n        if (level === prevLevel) { // 相等的话\n          entry = {\n            level,\n            children: [],\n            depth: lastNode.depth,\n            parent: lastNode.parent,\n            text,\n            el\n          };\n          lastNode.parent.children.push(entry);\n        } else if (level < prevLevel) { // 如果当前级别小于前一个\n          entry = {\n            level,\n            children: [],\n            depth: lastNode.depth + 1,\n            parent: lastNode,\n            text,\n            el\n          };\n          lastNode.children.push(entry);\n        } else { // 如果当前级别大于前一个 查找祖先节点\n          let ancestor = lastNode.parent;\n          while (ancestor.level <= level && !ancestor.root) {\n            ancestor = ancestor.parent;\n          }\n          entry = {\n            level,\n            children: [],\n            depth: ancestor.depth + 1,\n            parent: ancestor,\n            text,\n            el\n          };\n          ancestor.children.push(entry);\n        }\n      }\n      lastNode = entry;\n      prevLevel = level;\n    });\n\n    const html = this.generateMenusHtml(entries.children, this.config.prefix);\n    doc.querySelector(this.config.menu).innerHTML = html;\n  }\n\n  /**\n   * 根据 nodes 节点 生成 html\n   * @param nodes\n   * @param prefix\n   * @return {string}\n   */\n  generateMenusHtml(nodes, prefix) {\n    const {menuClsPrefix, menuCls} = this.config;\n    let html = '';\n    if (nodes && nodes.length > 0) {\n      html = `<ul class=\"${menuClsPrefix} ${menuClsPrefix}-catalogue${menuCls ? ` ${menuCls}` : ''}\">`;\n      for (let i = 0, len = nodes.length; i < len; i++) {\n        const node = nodes[i];\n        // 为对应的内容加锚点\n        const newChild = document.createElement('a');\n        newChild.id = prefix + (i + 1);\n        newChild.className = `${menuClsPrefix}-anchor`;\n        if (this.config.anchor) {\n          newChild.href = `#${prefix + (i + 1)}`;\n        } else {\n          newChild.dataset.menu = `${prefix + (i + 1)}`;\n        }\n\n        newChild.setAttribute('aria-hidden', true);\n        node.el.insertBefore(newChild, node.el.firstChild);\n\n        html += '<li>';\n        if (this.config.anchor) {\n          html += `<a class=\"${menuClsPrefix}-title\" href=\"#${prefix}${i + 1}\">${node.text}</a>`;\n        } else { // 用 data-target 来控制，需要结合 js 来控制\n          html += `<a class=\"${menuClsPrefix}-title\" data-target=\"${prefix}${i + 1}\" href=\"#\">${node.text}</a>`;\n        }\n        if (node.children && node.children.length > 0) {\n          html += this.generateMenusHtml(node.children, `${prefix}${i + 1}-`);\n        }\n        html += '</li>';\n      }\n      html += '</ul>';\n    }\n    return html;\n  }\n\n  /**\n   * 滚动页面时，刷新相关数据\n   */\n  refresh() {\n    const {offsetMethod} = this.config;\n    const offsetBase = offsetMethod === 'position' ? this.getScrollTop() : 0;\n\n    this.offsets = [];\n    this.targets = [];\n    this.scrollHeight = this.getScrollHeight();\n\n\n    // 把滚动监听的元素和坐标保存到offsets和targets中\n    const menuElements = doc.querySelectorAll(this.menuSelector);\n\n    map.call(menuElements, (element) => {\n      // 目标元素\n      let target = null;\n      const {anchor, container} = this.config;\n      const selector = anchor ? element.getAttribute('href') : element.dataset.menu;\n      const targetSelector = anchor ?\n        element.getAttribute('href') :\n        `${container} [data-target=\"${element.dataset.menu}\"]`;\n\n      if (targetSelector) {\n        target = doc.querySelector(targetSelector).parentNode;\n        const targetBCR = target.getBoundingClientRect();\n        if (targetBCR.width || targetBCR.height) {\n          return [\n            (offsetMethod === 'offset' ? offset(target).top : position(target).top) + offsetBase,\n            selector\n          ];\n        }\n      }\n      return null;\n    }).sort((a, b) => {\n      if (!a || !b) {\n        return 0;\n      }\n      return a[0] - b[0];\n    }).forEach((item) => {\n      if (item) {\n        this.offsets.push(item[0]);\n        this.targets.push(item[1]);\n      }\n    });\n  }\n\n  // 鼠标滚动事件\n  scrollEvent = (event) => {\n    this.process();\n  };\n\n  /**\n   * 滚动时触发该方法\n   * @returns {boolean|*}\n   */\n  process() {\n    // 需要加 1 微调\n    const scrollTop = this.getScrollTop() + this.config.offset + 1;\n    const scrollHeight = this.getScrollHeight();\n    const maxScroll = this.config.offset\n      + scrollHeight\n      - this.getOffsetHeight();\n\n    // 不相等的话，重新刷新，比如改变页面窗口后\n    if (this.scrollHeight !== scrollHeight) {\n      this.refresh();\n    }\n\n    // 滑到底部\n    if (scrollTop >= maxScroll) {\n      // 取最后一个\n      const target = this.targets[this.targets.length - 1];\n\n      if (this.activeTarget !== target) {\n        this.activate(target);\n      }\n      return;\n    }\n\n    // 滑到头部\n    if (this.activeTarget && scrollTop < this.offsets[0] && this.offsets[0] > 0) {\n      this.activeTarget = null;\n      this.clearActiveCls();\n      return;\n    }\n\n    for (let i = this.offsets.length; i--;) {\n      const isActiveTarget = this.activeTarget !== this.targets[i]\n        && scrollTop >= this.offsets[i]\n        && (this.offsets[i + 1] === undefined ||\n          scrollTop < this.offsets[i + 1]);\n\n      if (isActiveTarget) {\n        this.activate(this.targets[i]);\n      }\n    }\n  }\n\n  /**\n   * 设置当前活动的内容\n   * @param target\n   */\n  activate(target) {\n    this.activeTarget = target;\n\n    this.clearActiveCls();\n\n    const {anchor} = this.config;\n    let queries = this.menuSelector.split(',');\n    const lastSelector = []; // 最后一个菜单项，即当前的子节点\n    // 当前选中的和父目录都添加活动样式\n    const parentEls = target.split('-');\n    queries = queries.map((query) => {\n      const selector = [];\n      let catalog = '';\n      parentEls.forEach((it, index) => {\n        if (index === 0) {\n          catalog += it;\n        } else {\n          catalog += `-${it}`;\n          selector.push(anchor ? `${query}[href=\"${catalog}\"]` : `${query}[data-menu=\"${catalog}\"]`);\n        }\n      });\n      lastSelector.push(selector[selector.length - 1]);\n      return selector.join(',');\n    });\n\n    const $link = doc.querySelectorAll(queries.join(','));\n\n    for (let i = 0, len = $link.length; i < len; i++) {\n      $link[i].classList.add('active');\n    }\n\n    this.plugins.forEach((plugin) => {\n      if (typeof plugin.scrollMenu === 'function') {\n        plugin.scrollMenu(lastSelector);\n      }\n    });\n\n    // todo 事件，待补充\n\n    /* $(this._scrollElement).trigger(Event.ACTIVATE, {\n     relatedTarget: target\n     }) */\n  }\n\n  clearActiveCls() {\n    // 删除当前活动样式\n    const activeEls = doc.querySelectorAll(`${this.menuSelector}.active`);\n    if (activeEls) {\n      for (let i = 0, len = activeEls.length; i < len; i++) {\n        activeEls[i].classList.remove('active');\n      }\n    }\n  }\n\n  // 卸载\n  unmount() {\n    // $.removeData(this._element, DATA_KEY)\n    this.scrollElement.removeEventListener(isWheel ? 'mousewheel' : 'DOMMouseScroll', this.scrollEvent, false);\n\n    this.element = null;\n    this.scrollElement = null;\n    this.config = null;\n    this.menu = null;\n    this.menuSelector = null;\n    this.container = null;\n    this.offsets = null;\n    this.targets = null;\n    this.activeTarget = null;\n    this.scrollHeight = null;\n\n    // 卸载插件\n    if (this.plugins) {\n      this.plugins.forEach((plugin) => {\n        plugin.unmount();\n      });\n      this.plugins = null;\n    }\n  }\n\n  getScrollTop() {\n    return this.scrollElement === win ?\n      this.scrollElement.pageYOffset :\n      this.scrollElement.scrollTop;\n  }\n\n  getScrollHeight() {\n    return this.scrollElement.scrollHeight ||\n      Math.max(\n        doc.body.scrollHeight,\n        doc.documentElement.scrollHeight\n      );\n  }\n\n  getOffsetHeight() {\n    return this.scrollElement === win ?\n      win.innerHeight :\n      this.scrollElement.getBoundingClientRect().height;\n  }\n\n}\n\nconst ScrollSpy = ((perfect) => {\n  perfect.ScrollSpy = _ScrollSpy;\n  return _ScrollSpy;\n})(perfect);\n\nexport default ScrollSpy;\n"]}